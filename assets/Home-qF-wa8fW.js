import{u as k,q as u,j as r,r as C,B as v,a as w}from"./index-PDltHHk6.js";import{u as L,a as R,t as A,c as $,b as G,d as N,e as q,f as z,i as V,g as F,n as M,P as y,h as _,E as S}from"./PageLayout-4IIeUkt9.js";const B=()=>{const[t]=k(),s=t.get(u.tags),e=t.get(u.query),a=t.get(u.page),o=(()=>{const n=new URLSearchParams(t);return n.set(u.tags,`(${s||"front_page"})`),n.set(u.page,(parseInt(a??"1")-1).toString()),e&&(n.set(u.restrictSearchableAttributes,"title,comment_text,url,story_text,author"),n.set(u.tags,"story"),n.set(u.query,e)),n.toString()})(),c=e?"search_by_date":"search";return L({queryKey:["HN",o],queryFn:()=>R(`http://hn.algolia.com/api/v1/${c}?${o}`)})},U=({title:t,createdBy:s,upvotesCount:e,commentsCount:a,createdAt:g,link:o,onClick:c})=>r.jsx("div",{className:"item cursor-pointer py-4 px-5 border bg-opacity-25 border-transparent transition hover:border-primary-500 dark:hover:bg-primary-600 dark:hover:bg-opacity-[0.1] border-b group",onClick:c,children:r.jsxs("div",{className:"w-full",children:[r.jsx("h4",{className:"font-bold dark:font-semibold tracking-wide text-lg leading-tight",children:t}),o?r.jsx("div",{className:"w-full overflow-hidden",children:r.jsx("a",{className:"inline-block mt-2 text-sm text-gray-600 dark:text-gray-400 leading-tight truncate min-w-0 font-medium",href:o,target:"_blank",rel:"noopener",onClick:i=>i.stopPropagation(),children:o})}):null,r.jsxs("div",{className:"flex mt-1 items-center justify-between flex-wrap",children:[r.jsxs("div",{className:"font-semibold text-sm mr-2 flex items-center flex-shrink-0 text-primary-700 dark:text-primary-600 text-opacity-100",children:[r.jsx("span",{className:"font-bold",children:e}),r.jsx("span",{className:"mx-2",children:"•"}),r.jsx("span",{className:"opacity-90",children:s}),r.jsx("span",{className:"text-gray-400 dark:text-gray-500 mx-2",children:"•"}),r.jsx("span",{className:"text-gray-500 text-xs font-medium",children:A(g)})]}),r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{className:"comments uppercase text-xs transition font-semibold group-hover:font-bold text-gray-600 dark:text-gray-400 group-hover:text-white",children:[a," Comments"]})})]})]})});var O=$("pagination").parts("root","item","ellipsis","prevTrigger","nextTrigger"),x=O.build(),P=G({getRootId:t=>{var s;return((s=t.ids)==null?void 0:s.root)??`pagination:${t.id}`},getPrevTriggerId:t=>{var s;return((s=t.ids)==null?void 0:s.prevTrigger)??`pagination:${t.id}:prev`},getNextTriggerId:t=>{var s;return((s=t.ids)==null?void 0:s.nextTrigger)??`pagination:${t.id}:next`},getEllipsisId:(t,s)=>{var e,a;return((a=(e=t.ids)==null?void 0:e.ellipsis)==null?void 0:a.call(e,s))??`pagination:${t.id}:ellipsis:${s}`},getItemId:(t,s)=>{var e,a;return((a=(e=t.ids)==null?void 0:e.item)==null?void 0:a.call(e,s))??`pagination:${t.id}:item:${s}`}}),b=(t,s)=>{let e=s-t+1;return Array.from({length:e},(a,g)=>g+t)},Q=t=>t.map(s=>typeof s=="number"?{type:"page",value:s}:{type:"ellipsis"}),f="ellipsis",D=t=>{const s=Math.min(2*t.siblingCount+5,t.totalPages),e=1,a=t.totalPages,g=Math.max(t.page-t.siblingCount,e),o=Math.min(t.page+t.siblingCount,a),c=g>e+1,i=o<a-1,n=s-2;if(!c&&i)return[...b(1,n),f,a];if(c&&!i){const p=b(a-n+1,a);return[e,f,...p]}if(c&&i){const p=b(g,o);return[e,f,...p,f,a]}return b(e,a)},H=t=>Q(D(t));function X(t,s,e){const a=t.context.totalPages,g=t.context.page,o=t.context.translations,c=t.context.previousPage,i=t.context.nextPage,n=t.context.pageRange,p=t.context.type==="button",j=g===1,T=g===a;return{page:g,totalPages:a,pages:H(t.context),previousPage:c,nextPage:i,pageRange:n,isFirstPage:j,isLastPage:T,slice(d){return d.slice(n.start,n.end)},setCount(d){s({type:"SET_COUNT",count:d})},setPageSize(d){s({type:"SET_PAGE_SIZE",size:d})},setPage(d){s({type:"SET_PAGE",page:d})},rootProps:e.element({id:P.getRootId(t.context),...x.root.attrs,dir:t.context.dir,"aria-label":o.rootLabel}),getEllipsisProps(d){return e.element({id:P.getEllipsisId(t.context,d.index),...x.ellipsis.attrs,dir:t.context.dir})},getItemProps(d){var I;const m=d.value,E=m===t.context.page;return e.element({id:P.getItemId(t.context,m),...x.item.attrs,dir:t.context.dir,"data-index":m,"data-selected":N(E),"aria-current":E?"page":void 0,"aria-label":(I=o.itemLabel)==null?void 0:I.call(o,{page:m,totalPages:a}),onClick(){s({type:"SET_PAGE",page:m})},...p&&{type:"button"}})},prevTriggerProps:e.element({id:P.getPrevTriggerId(t.context),...x.prevTrigger.attrs,dir:t.context.dir,"data-disabled":N(j),"aria-label":o.prevTriggerLabel,onClick(){s({type:"PREVIOUS_PAGE"})},...p&&{disabled:j,type:"button"}}),nextTriggerProps:e.element({id:P.getNextTriggerId(t.context),...x.nextTrigger.attrs,dir:t.context.dir,"data-disabled":N(T),"aria-label":o.nextTriggerLabel,onClick(){s({type:"NEXT_PAGE"})},...p&&{disabled:T,type:"button"}})}}function Z(t){const s=q(t);return z({id:"pagination",initial:"idle",context:{pageSize:10,siblingCount:1,page:1,type:"button",translations:{rootLabel:"pagination",prevTriggerLabel:"previous page",nextTriggerLabel:"next page",itemLabel({page:e,totalPages:a}){return`${a>1&&e===a?"last page, ":""}page ${e}`},...s.translations},...s},watch:{pageSize:["setPageIfNeeded"]},computed:{totalPages:e=>Math.ceil(e.count/e.pageSize),previousPage:e=>e.page===1?null:e.page-1,nextPage:e=>e.page===e.totalPages?null:e.page+1,pageRange:e=>{const a=(e.page-1)*e.pageSize,g=a+e.pageSize;return{start:a,end:g}},isValidPage:e=>e.page>=1&&e.page<=e.totalPages},on:{SET_COUNT:[{guard:"isValidCount",actions:["setCount","goToFirstPage"]},{actions:"setCount"}],SET_PAGE:{guard:"isValidPage",actions:"setPage"},SET_PAGE_SIZE:{actions:"setPageSize"},PREVIOUS_PAGE:{guard:"canGoToPrevPage",actions:"goToPrevPage"},NEXT_PAGE:{guard:"canGoToNextPage",actions:"goToNextPage"}},states:{idle:{}}},{guards:{isValidPage:(e,a)=>a.page>=1&&a.page<=e.totalPages,isValidCount:(e,a)=>e.page>a.count,canGoToNextPage:e=>e.page<e.totalPages,canGoToPrevPage:e=>e.page>1},actions:{setCount(e,a){e.count=a.count},setPage(e,a){h.page(e,a.page)},setPageSize(e,a){e.pageSize=a.size},goToFirstPage(e){h.page(e,1)},goToPrevPage(e){h.page(e,e.page-1)},goToNextPage(e){h.page(e,e.page+1)},setPageIfNeeded(e,a){e.isValidPage||h.page(e,1)}}})}var h={page:(t,s)=>{var e;V(t.page,s)||(t.page=s,(e=t.onPageChange)==null||e.call(t,{page:t.page,pageSize:t.pageSize}))}};const K=({totalItems:t,page:s,pageSize:e,onPageChange:a})=>{const g=C.useId(),[o,c]=F(Z({id:g,count:t,page:s,pageSize:e,onPageChange:a})),i=X(o,c,M);return r.jsx("div",{className:"py-4 px-5 sm:py-3 sm:px-4",children:i.totalPages>1&&r.jsx("nav",{...i.rootProps,children:r.jsxs("ul",{className:"inline-flex gap-2 items-center flex-wrap",children:[r.jsx("li",{children:r.jsx(v,{disabled:i.isFirstPage,...i.prevTriggerProps,children:"Previous"})}),i.pages.map((n,l)=>n.type==="page"?C.createElement("li",{...i.getItemProps(n),className:`cursor-pointer text-xs px-2 py-1 md:px-3 md:py-2 border border-gray-800 h-full grid place-items-center ${i.page===n.value?"bg-primary-600":"bg-transparent"}`,key:n.value},r.jsx("span",{children:n.value})):r.jsx("li",{className:"cursor-pointer",children:r.jsx("span",{...i.getEllipsisProps({index:l}),children:"…"})},`ellipsis-${l}`)),r.jsx("li",{children:r.jsx(v,{disabled:i.isLastPage,...i.nextTriggerProps,children:"Next"})})]})})})},Y=()=>{const{data:t,isLoading:s,isError:e,isFetching:a,refetch:g}=B(),o=w(),[c,i]=k(),n=(l,p)=>{c.set(l,p),i(c)};return s?r.jsxs(y,{children:[r.jsx("div",{className:"sticky top-0",children:r.jsx(_,{isIntermediate:a})}),r.jsx(S,{title:"Loading...",description:"Loading your results. Please wait a moment"})]}):e||!t?r.jsx(y,{children:r.jsx(S,{title:"Error",description:"There was an error in completing your request. Please try again",actions:r.jsx(v,{onClick:()=>g(),disabled:a,children:"Retry"})})}):t.hits.length===0?r.jsx(y,{children:r.jsx(S,{title:"No results found",description:"There are no results available currently. Please try updating the filters above and refresh below to check again",actions:r.jsx(v,{onClick:()=>g(),disabled:a,children:"Refresh"})})}):r.jsx(y,{children:r.jsxs("div",{className:"grid grid-rows-[auto_1fr_auto] overflow-auto",children:[r.jsx("div",{className:"sticky top-0",children:r.jsx(_,{isIntermediate:a})}),r.jsx("ol",{className:"overflow-auto",children:t.hits.map(l=>r.jsx("li",{children:r.jsx(U,{onClick:p=>{p.preventDefault(),o(`/${l.objectID}`)},commentsCount:l.num_comments,createdAt:l.created_at,createdBy:l.author,title:l.title,link:l.url,upvotesCount:l.points})},l.objectID))}),r.jsx("div",{className:"sticky bottom-0 bg-gray-100 dark:bg-gray-900 dark:text-gray-300 grid place-items-center w-full",children:r.jsx(K,{page:t.page+1,pageSize:t.hitsPerPage,totalItems:t.nbPages*t.hitsPerPage,onPageChange:({page:l})=>{n(u.page,l.toString())}})})]})})};export{Y as default};
//# sourceMappingURL=Home-qF-wa8fW.js.map
